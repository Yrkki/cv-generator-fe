<ng-template #menu let-position="position">
    <app-navigation [position]="position"></app-navigation>
</ng-template>
<ng-template #search let-position="position">
    <app-search [position]="position"></app-search>
</ng-template>

<aside role="complementary">
    <title>CV Generator</title>

    <div *ngIf="(cvDefined() || projectsDefined()) && uiDefined()" class="non-printable">
        <ng-container *ngTemplateOutlet="menu;context:{position: ''}"></ng-container>
        <ng-container *ngTemplateOutlet="search;context:{position: ''}"></ng-container>
    </div>
</aside>

<main role="main">
    <div *ngIf="cvDefined() && entitiesDefined() && uiDefined()">
        <header id="{{ entities['Curriculum Vitae']?.key }}" data-toggle="collapse" data-target="#CurriculumVitaeContent" role="tabpanel"
            [attr.aria-labelledby]="tabName('Curriculum Vitae')">
            <h1>{{ entities['Curriculum Vitae']?.section }} ({{ 3 + count(cv['Professional experience'], "Period") + count(cv['Education'],
                "Period") + count(cv['Certifications'], "Certification", "~") + count(cv['Languages'], "Language") + countCache['Name']
                + countCache['Title'] }})
            </h1>
        </header>
        <div id="CurriculumVitaeContent" class="collapse show">
            <div class="tryKeepTogether">
                <header id="{{ entities['Personal Data']?.key }}" data-toggle="collapse" data-target="#PersonalDataContent" [attr.aria-labelledby]="tabName('Personal Data')">
                    <h2>{{ entities['Personal Data']?.section }} (3)</h2>
                </header>
                <div id="PersonalDataContent" class="collapse show">
                    <app-personal-data [propertyName]="cv['Personal data']"></app-personal-data>
                </div>
            </div>

            <header id="{{ entities['Background']?.key }}" data-toggle="collapse" data-target="#BackgroundContent" [attr.aria-labelledby]="tabName('Background')">
                <h2>{{ entities['Background']?.section }} ({{ count(cv['Professional experience'], "Period") + count(cv['Education'],
                    "Period") }})</h2>
            </header>
            <div id="BackgroundContent" class="collapse show">
                <div class="tryKeepTogether">
                    <header id="{{ entities['Professional Experience']?.key }}" data-toggle="collapse" data-target="#ProfessionalExperienceContent"
                        [attr.aria-labelledby]="tabName('Professional Experience')">
                        <h3>{{ entities['Professional Experience']?.section }} ({{ count(cv['Professional experience'], "Period")
                            }})
                        </h3>
                    </header>
                    <div id="ProfessionalExperienceContent" class="collapse show">
                        <div *ngFor="let professionalExperience of cv['Professional experience']">
                            <app-professional-experience [propertyName]="professionalExperience"></app-professional-experience>
                        </div>
                    </div>
                </div>

                <div class="tryKeepTogether">
                    <header id="{{ entities['Education']?.key }}" data-toggle="collapse" data-target="#EducationContent" [attr.aria-labelledby]="tabName('Education')">
                        <h3>{{ entities['Education']?.section }} ({{ count(cv['Education'], "Period") }})</h3>
                    </header>
                    <div id="EducationContent" class="collapse show">
                        <div *ngFor="let school of cv['Education']">
                            <app-education [propertyName]="school"></app-education>
                        </div>
                    </div>
                </div>
            </div>

            <header id="{{ entities['Accomplishments']?.key }}" data-toggle="collapse" data-target="#AccomplishmentsContent" [attr.aria-labelledby]="tabName('Accomplishments')">
                <h2>{{ entities['Accomplishments']?.section }} ({{ count(cv['Certifications'], "Certification", "~") + count(cv['Languages'],
                    "Language") + countCache['Name'] + countCache['Title'] }})</h2>
            </header>
            <div id="AccomplishmentsContent" class="collapse show">
                <div class="tryKeepTogether">
                    <header id="{{ entities['Certifications']?.key }}" data-toggle="collapse" data-target="#CertificationsContent" [attr.aria-labelledby]="tabName('Certifications')">
                        <h3>{{ entities['Certifications']?.section }} ({{ count(cv['Certifications'], "Certification", "~") }})</h3>
                    </header>
                    <div id="CertificationsContent" class="collapse show">
                        <div *ngFor="let certification of cv['Certifications']">
                            <app-certification [propertyName]="certification"></app-certification>
                        </div>
                    </div>
                </div>

                <div class="tryKeepTogether">
                    <header id="{{ entities['Languages']?.key }}" data-toggle="collapse" data-target="#LanguagesContent" [attr.aria-labelledby]="tabName('Languages')">
                        <h3>{{ entities['Languages']?.section }} ({{ count(cv['Languages'], "Language") }})</h3>
                    </header>
                    <div id="LanguagesContent" class="collapse show" align="center">
                        <app-language [propertyName]="language"></app-language>
                    </div>
                </div>

                <header id="{{ entities['Courses']?.key }}" data-toggle="collapse" data-target="#CoursesContent" [attr.aria-labelledby]="tabName('Courses')">
                    <h3>{{ entities['Courses']?.section }} ({{ countCache['Name'] }})</h3>
                </header>
                <div id="CoursesContent" class="collapse show">
                    <div class="tryKeepTogether">
                        <header id="{{ entities['Courses Index']?.key }}" data-toggle="collapse" data-target="#CoursesIndexContent" [attr.aria-labelledby]="tabName('Courses Index')">
                            <h4>{{ entities['Courses Index']?.section }} ({{ countCache['Name'] }})</h4>
                        </header>
                        <div id="CoursesIndexContent" class="collapse show">
                            <div style="display: flex; flex-wrap: wrap;">
                                <div *ngFor="let course of filteredAccomplishments">
                                    <span class='frequency'>
                                        <a (click)="searchToken=course['Name'];" target="_blank" [attr.aria-label]="course['Name']">
                                            {{ course['Name'] }}
                                        </a>
                                    </span>
                                    <span *ngIf="course != filteredAccomplishments[filteredAccomplishments.length-1]"> {{ frequenciesDivider }}&nbsp;</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <header id="{{ entities['Courses List']?.key }}" data-toggle="collapse" data-target="#CoursesListContent" [attr.aria-labelledby]="tabName('Courses List')">
                        <h4>{{ entities['Courses List']?.section }} ({{ countCache['Name'] }})</h4>
                    </header>
                    <div id="CoursesListContent" class="collapse show">
                        <div *ngFor="let course of filteredAccomplishments">
                            <app-course [propertyName]="course"></app-course>
                        </div>
                    </div>
                </div>

                <div class="tryKeepTogether">
                    <header id="{{ entities['Publications']?.key }}" data-toggle="collapse" data-target="#PublicationsContent" [attr.aria-labelledby]="tabName('Publications')">
                        <h3>{{ entities['Publications']?.section }} ({{ countCache['Title'] }})</h3>
                    </header>
                    <div id="PublicationsContent" class="collapse show">
                        <div *ngFor="let publication of filteredPublications">
                            <app-publication [propertyName]="publication"></app-publication>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <ng-template #frequencies let-key="key">
            <div class="tryKeepTogether">
                <header id="{{ key }}" data-toggle="collapse" [attr.data-target]="'#' + entities[key]?.content" [attr.aria-labelledby]="tabName(key)">
                    <h3>{{ entities[key]?.section }} ({{ countCache[key] }})</h3>
                </header>
                <div id="{{ entities[key]?.content }}" class="collapse show">
                    <span *ngIf="tagCloud==this.tagCloudDisplayMode.tagCloud || tagCloud==this.tagCloudDisplayMode.both">
                        <span *ngFor="let frequency of getFrequenciesCache(key); let i = index;">
                            <span class='frequency' [ngStyle]="{color: 'hsl(120, 0%, '+frequency[1].Lightness+'%)'}">
                                <a (click)='searchToken=frequency[0];' [attr.aria-label]="frequency[0]">{{ frequency[0] }}</a>
                            </span>
                            <span *ngIf="i != countCache[key] - 1"> {{ frequenciesDivider }}</span>
                        </span>
                    </span>
                    <span *ngIf="tagCloud==this.tagCloudDisplayMode.chart || tagCloud==this.tagCloudDisplayMode.both">
                        <div *ngIf="getFrequenciesCache(key).length > 0">
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-md-12 cell-value">
                                        <canvas id="{{ entities[key]?.chart }}" height="250" width="2300" style="display:block; float:left; width: 100%;"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </span>
                </div>
            </div>
        </ng-template>

        <div *ngIf="projectsDefined()">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-9" style="border: 0px; padding: 0px;">
                        <header id="{{ entities['Project Summary']?.key }}" data-toggle="collapse" data-target="#ProjectSummaryContent" [attr.aria-labelledby]="tabName('Project Summary')">
                            <h1>{{ entities['Project Summary']?.section }} ({{ countCache[entities['Project Summary'].node] }})</h1>
                        </header>
                    </div>
                    <div class="col-md-3 non-printable" style="border: 0px, 10px, 0px, 0px; border-color: transparent">
                        <span align="right" class="btn-group" role="radiogroup" aria-labelledby="viewMode">
                            <span id="viewMode" style="padding-top: 6px;">{{ ui['Mode'].text }}:</span>
                            <label id="tag cloud label" for="tag cloud radio" class="btn" (click)="this.tagCloud=this.tagCloudDisplayMode.tagCloud">
                                <input type="radio" id="tag cloud radio" [(ngModel)]="tagCloud" [value]="tagCloudDisplayMode.tagCloud" name="options" role="radio"
                                    aria-labelledby="tag cloud label">{{ ui['tag cloud'].text }}
                            </label>
                            <label id="chart label" for="chart radio" class="btn" (click)="this.tagCloud=this.tagCloudDisplayMode.chart">
                                <input type="radio" id="chart radio" [(ngModel)]="tagCloud" [value]="tagCloudDisplayMode.chart" name="options" role="radio"
                                    aria-labelledby="chart label">{{ ui['chart'].text }}
                            </label>
                            <label id="both label" for="both radio" class="btn" (click)="this.tagCloud=this.tagCloudDisplayMode.both">
                                <input type="radio" id="both radio" [(ngModel)]="tagCloud" [value]="tagCloudDisplayMode.both" name="options" role="radio"
                                    aria-labelledby="both label">{{ ui['both'].text }}
                            </label>
                        </span>
                    </div>
                </div>
            </div>
            <div id="ProjectSummaryContent" class="collapse show">
                <header id="{{ entities['Areas of Expertise']?.key }}" data-toggle="collapse" data-target="#AreasOfExpertiseContent" [attr.aria-labelledby]="tabName('Areas of Expertise')">
                    <h2>{{ entities['Areas of Expertise']?.section }} ({{ countCache[entities['Areas of Expertise'].node] }})</h2>
                </header>
                <div id="AreasOfExpertiseContent" class="collapse show">
                    <ng-container *ngTemplateOutlet="frequencies;context:{key: 'Client'}"></ng-container>
                    <ng-container *ngTemplateOutlet="frequencies;context:{key: 'Industry'}"></ng-container>
                    <ng-container *ngTemplateOutlet="frequencies;context:{key: 'Project type'}"></ng-container>
                    <ng-container *ngTemplateOutlet="frequencies;context:{key: 'System type'}"></ng-container>
                </div>

                <header id="{{ entities['Skills']?.key }}" data-toggle="collapse" data-target="#SkillsContent" [attr.aria-labelledby]="tabName('Skills')">
                    <h2>{{ entities['Skills']?.section }} ({{ countCache[entities['Skills'].node] }})</h2>
                </header>
                <div id="SkillsContent" class="collapse show">
                    <ng-container *ngTemplateOutlet="frequencies;context:{key: 'Platform'}"></ng-container>
                    <ng-container *ngTemplateOutlet="frequencies;context:{key: 'Architecture'}"></ng-container>
                    <ng-container *ngTemplateOutlet="frequencies;context:{key: 'Languages and notations'}"></ng-container>
                    <ng-container *ngTemplateOutlet="frequencies;context:{key: 'IDEs and Tools'}"></ng-container>
                </div>

                <header id="{{ entities['Job Functions']?.key }}" data-toggle="collapse" data-target="#WorkExperienceContent" [attr.aria-labelledby]="tabName('Job Functions')">
                    <h2>{{ entities['Job Functions']?.section }} ({{ countCache[entities['Job Functions'].node] }})</h2>
                </header>
                <div id="WorkExperienceContent" class="collapse show">
                    <ng-container *ngTemplateOutlet="frequencies;context:{key: 'Role'}"></ng-container>
                    <ng-container *ngTemplateOutlet="frequencies;context:{key: 'Responsibilities'}"></ng-container>
                    <ng-container *ngTemplateOutlet="frequencies;context:{key: 'Team size'}"></ng-container>
                    <ng-container *ngTemplateOutlet="frequencies;context:{key: 'Position'}"></ng-container>
                </div>
            </div>

            <div *ngIf="projectsDefined()">
                <header id="{{ entities['Project Portfolio']?.key }}" data-toggle="collapse" data-target="#ProjectPortfolioContent" [attr.aria-labelledby]="tabName('Project Portfolio')">
                    <h1>{{ entities['Project Portfolio']?.section }} ({{ filteredProjects.length }})</h1>
                </header>
                <div id="ProjectPortfolioContent" class="collapse show">
                    <div class="tryKeepTogether">
                        <header id="{{ entities['Gantt Chart']?.key }}" data-toggle="collapse" data-target="#GanttChartContent" [attr.aria-labelledby]="tabName('Gantt Chart')">
                            <h2>{{ entities['Gantt Chart']?.section }} ({{ filteredProjects.length }})</h2>
                        </header>
                        <div id="GanttChartContent" class="collapse show">
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-md-12 cell-value">
                                        <canvas id="Project Gantt chart" height="900" width="1600" style="display:block; float:left; max-width: 100%;"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <header id="{{ entities['List']?.key }}" data-toggle="collapse" data-target="#ListContent" [attr.aria-labelledby]="tabName('List')">
                        <h2>{{ entities['List']?.section }} ({{ filteredProjects.length }})</h2>
                    </header>
                    <div id="ListContent" class="collapse show">
                        <div class="table-responsive">
                            <table class="table table-condensed">
                                <thead>
                                    <tr class="list-row">
                                        <th>{{ toTitleCase(entities['Id'].node) }}</th>
                                        <th>{{ toTitleCase(entities['From'].node) }}</th>
                                        <th>{{ toTitleCase(entities['To'].node) }}</th>
                                        <th>{{ toTitleCase(entities['Project name'].node) }}</th>
                                        <th>{{ toTitleCase(entities['Industry'].node) }}</th>
                                        <th>{{ toTitleCase(entities['Project type'].node) }}</th>
                                        <th>{{ toTitleCase(entities['Role'].node) }}</th>
                                    </tr>
                                </thead>
                                <tbody *ngFor="let project of filteredProjects">
                                    <tr [ngClass]="{
                                'warning': getDecryptedProjectPeriod(project) == 'Modern Age', 
                                'info': getDecryptedProjectPeriod(project) == 'Renaissance', 
                                'success': getDecryptedProjectPeriod(project) == 'Dark Ages' }" class="list-row">
                                        <td>{{ project['Id'] }}</td>
                                        <td>{{ getJsDateValueFromExcel(project['From']) | date:'MM.yyyy' }}</td>
                                        <td>{{ getJsDateValueFromExcel(project['To']) | date:'MM.yyyy' }}</td>
                                        <td>
                                            <a href="/{{ componentName }}#project{{ project['Id'] }}">{{ project['Project name'] }}</a>
                                        </td>
                                        <td>{{ project['Industry'] }}</td>
                                        <td>{{ project['Project type'] }}</td>
                                        <td>{{ project['Role'] }}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tryKeepTogether">
                        <header id="{{ entities['Index']?.key }}" data-toggle="collapse" data-target="#IndexContent" [attr.aria-labelledby]="tabName('Index')">
                            <h2>{{ entities['Index']?.section }} ({{ filteredProjects.length }})</h2>
                        </header>
                        <div id="IndexContent" class="collapse show">
                            <div style="display: flex; flex-wrap: wrap;">
                                <div *ngFor="let project of filteredProjects">
                                    <a href="/{{ componentName }}#project{{ project['Id'] }}">{{ project['Project name'] }}</a>
                                    <span *ngIf="project != filteredProjects[filteredProjects.length-1]"> {{ frequenciesDivider }}&nbsp;</span>
                                </div>
                            </div>
                        </div>

                    </div>

                    <header id="{{ entities['Projects']?.key }}" data-toggle="collapse" data-target="#ProjectsContent" [attr.aria-labelledby]="tabName('Projects')">
                        <h2>{{ entities['Projects']?.section }} ({{ filteredProjects.length }})</h2>
                    </header>
                    <div id="ProjectsContent" class="collapse show">
                        <div *ngFor="let project of filteredProjects;">
                            <h3 *ngIf="project['New Period'] !== '' && entities.hasOwnProperty(getDecryptedProjectPeriod(project))" id="{{ entities[getDecryptedProjectPeriod(project)]?.key }}"
                                [attr.aria-labelledby]="tabName(getDecryptedProjectPeriod(project))">
                                {{ entities[getDecryptedProjectPeriod(project)]?.section }} ({{ countCache[getDecryptedProjectPeriod(project)] }})
                            </h3>
                            <div class="tryKeepTogether">
                                <div class="container-fluid border">
                                    <div class="row" id="project{{ project['Id'] }}">
                                        <div class="col-md-11 cell-title cell-right-touching">
                                            <div *ngIf="!isEmptyProjectProjectImage(project['Photos'])">
                                                <a href="{{ project['Links'] }}" target="_blank">
                                                    <img class="table-responsive" width="900" src="{{ getProjectProjectImageUri(project['Photos']) }}" onerror="this.style.display='none'"
                                                        alt="{{ project['Project name'] }}" />
                                                </a>
                                            </div>
                                            <h4>
                                                {{ project['Project name'] }}
                                            </h4>
                                            <span>
                                                {{ project['Scope'] }}
                                            </span>
                                        </div>
                                        <div class="col-md-1 cell-title faded-fore cell-left-touching" style="text-align: right;">
                                            <span>
                                                {{ project['Id'] }}
                                            </span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 cell-capacity">
                                            <span style="font-weight: bold;">
                                                {{ getJsDateValueFromExcel(project['From']) | date:'MMMM yyyy' }} - {{ getJsDateValueFromExcel(project['To']) | date:'MMMM
                                                yyyy'}}
                                            </span>
                                        </div>
                                        <div class="col-md-3 cell-capacity">
                                            <span>
                                                {{ project['Duration total'] }}
                                            </span>
                                        </div>
                                        <div class="col-md-3 cell-capacity">
                                            <span>
                                                {{ project['Team size'] }} team members
                                            </span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-3 cell-normal">
                                            <table width="100%">
                                                <tr>
                                                    <td valign="top">
                                                        <div class="cell-header">
                                                            {{ entities['Client'].node }}
                                                            <br />
                                                        </div>
                                                        <span>
                                                            {{ project['Client'] }}
                                                        </span>
                                                    </td>
                                                    <td align="right">
                                                        <a href="{{ project['Client link'] }}" target="_blank">
                                                            <img src="{{ getProjectLogoUri(project['Logo']) }}" onerror="this.style.display='none'" style="max-width:50px; max-height:50px"
                                                                alt="{{ project['Client'] }}" />
                                                        </a>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div class="col-md-3 cell-normal">
                                            <div class="cell-header">
                                                {{ entities['Industry'].node }}
                                                <br />
                                            </div>
                                            <span style="font-weight: bold;">
                                                {{ project['Industry'] }}
                                            </span>
                                        </div>
                                        <div class="col-md-3 cell-normal">
                                            <div class="cell-header">
                                                {{ entities['Project type'].node }}
                                                <br />
                                            </div>
                                            <span style="font-weight: bold;">
                                                {{ project['Project type'] }}
                                            </span>
                                        </div>
                                        <div class="col-md-3 cell-normal">
                                            <div class="cell-header">
                                                {{ entities['System type'].node }}
                                                <br />
                                            </div>
                                            <span>
                                                {{ project['System type'] }}
                                            </span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-3 cell-normal">
                                            <div class="cell-header">
                                                {{ entities['Platform'].node }}
                                                <br />
                                            </div>
                                            <span>
                                                {{ project['Platform'] }}
                                            </span>
                                        </div>
                                        <div class="col-md-3 cell-normal">
                                            <div class="cell-header">
                                                {{ entities['Architecture'].node }}
                                                <br />
                                            </div>
                                            <span>
                                                {{ project['Architecture'] }}
                                            </span>
                                        </div>
                                        <div class="col-md-3 cell-normal">
                                            <div class="cell-header">
                                                {{ entities['Languages and notations'].node }}
                                                <br />
                                            </div>
                                            <span>
                                                {{ project['Languages and notations'] }}
                                            </span>
                                        </div>
                                        <div class="col-md-3 cell-normal">
                                            <div class="cell-header">
                                                {{ entities['IDEs and Tools'].node }}
                                                <br />
                                            </div>
                                            <span>
                                                {{ project['IDEs and Tools'] }}
                                            </span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-3 cell-feature">
                                            <div class="cell-header">
                                                {{ entities['Role'].node }}
                                                <br />
                                            </div>
                                            <span>
                                                {{ project['Role'] }}
                                            </span>
                                        </div>
                                        <div class="col-md-6 cell-feature">
                                            <div class="cell-header">
                                                {{ entities['Responsibilities'].node }}
                                                <br />
                                            </div>
                                            <span>
                                                {{ project['Responsibilities'] }}
                                            </span>
                                        </div>
                                        <div class="col-md-3 cell-normal">
                                            <div class="cell-header">
                                                {{ entities['Position'].node }}
                                                <br />
                                            </div>
                                            <span>
                                                {{ project['Position'] }}
                                            </span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div *ngIf="project['Links']" class="col-md-12 cell-faded">
                                            <span>
                                                <a href="{{ project['Links'] }}" target="_blank">{{ project['Links'] }}</a>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div *ngIf="project['Reference']" class="col-md-12 cell-faded faded-fore" style="text-align: right;">
                                            <div class="cell-header faded-fore">
                                                {{ entities['References'].node }}
                                                <br />
                                            </div>
                                            <span>
                                                {{ project['Reference'] }}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <br />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<aside role="complementary">
    <div *ngIf="(cvDefined() || projectsDefined()) && uiDefined()" class="non-printable">
        <div id="footer" class="container text-right">
            <a href='/{{ componentName }}#'>
                <img src="{{ getAssetUri('back_to_top.png') }}" onerror="this.style.display='none'" style="max-width:32px; max-height:32px; border:0;"
                    alt="Up" />
            </a>
        </div>
        <br />

        <ng-container *ngTemplateOutlet="search;context:{position: ' bottom'}"></ng-container>
        <ng-container *ngTemplateOutlet="menu;context:{position: ' bottom'}"></ng-container>

    </div>
</aside>

<footer role="contentinfo">
    <div *ngIf="(cvDefined() || projectsDefined()) && uiDefined()" class="non-printable">
        <div class="disclaimer" align="center">
            {{ ui['Disclaimer'].text }}
        </div>
    </div>
</footer>