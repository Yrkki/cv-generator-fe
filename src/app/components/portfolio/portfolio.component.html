<ng-template #menu let-position="position">
    <app-navigation [position]="position"></app-navigation>
</ng-template>

<ng-template #search let-position="position">
    <app-search [position]="position"></app-search>
</ng-template>

<ng-template #headerLink let-key="key">
    <a [ngClass]="[(entities[key]?.class ? entities[key]?.class : ''), 'header-link']" (click)="$event.stopPropagation()" title="{{ linkToThisText }}"
        href="/{{ componentName }}#{{ key }}">
        <i class="material-icons d-print-none">{{ linkToThisSymbol }}</i>
    </a>
</ng-template>

<ng-template #sectionCounter let-count="count">
    <ng-container *ngIf="count > 0">
        <span class="ghost d-print-none">
            ({{ count }})
        </span>
    </ng-container>
</ng-template>

<nav role="navigation" class="navbar navbar-expand-md navbar-light shadow-sm p-2 mb-2 background-color rounded d-print-none">
    <title>{{ ui['CV Generator']?.text }}</title>

    <a class="navbar-brand d-flex d-md-block align-items-baseline" href="/" [attr.aria-label]="ui['CV Generator']?.text">
        <img src="{{ getAssetUri('CV Generator logo.png') }}" onerror="this.style.display='none'" alt="" />
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
        aria-expanded="false" [attr.aria-label]="ui['Toggle navigation']?.text">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div *ngIf="uiDefined() && (cvDefined() || projectsDefined() || generalTimelineDefined())" class="flex-grow-1">
            <ng-container *ngTemplateOutlet="menu;context:{position: ''}"></ng-container>
            <ng-container *ngTemplateOutlet="search;context:{position: ''}"></ng-container>
        </div>
    </div>
</nav>

<main role="main" class="container-fluid">
    <div *ngIf="entitiesDefined() && uiDefined()">
        <div *ngIf="cvDefined()">
            <div class="tryKeepTogether">
                <header id="{{ entities['Curriculum Vitae']?.key }}" (click)="saveToggle($event)" data-toggle="collapse" [attr.data-target]="'#' + entities['Curriculum Vitae']?.content"
                    [attr.aria-labelledby]="tabName('Curriculum Vitae')">
                    <h1 [class.decorations]="decorations">
                        <ng-container *ngTemplateOutlet="headerLink;context:{key: 'Curriculum Vitae'}"></ng-container>
                        {{ entities['Curriculum Vitae']?.section }}
                        <ng-container *ngTemplateOutlet="sectionCounter;context:{count: count(cv['Personal data'], 'Personal data', '~') + count(cv['Education'], 'To') + count(cv['Professional experience'],'To') + count(cv['Certifications'], 'Name', '~') + count(cv['Languages'], 'Language') + countCache['Name'] + countCache['Title']}"></ng-container>

                        <ng-container *ngIf="decorations; else elseBlock">
                            <span class="d-print-none extra-function" [attr.aria-labelledby]="label('decorations')" (click)="$event.stopPropagation()"
                                title="{{ ui['Decorations']?.text }}">
                                <label id="{{ label('decorations') }}" for="decorations checkbox" class="switch">
                                    <input type="checkbox" id="decorations checkbox" [(ngModel)]="decorations" value="" role="checkbox" [attr.aria-labelledby]="label('decorations')"
                                        title="">
                                    <span class="slider round"></span>
                                </label>
                            </span>
                        </ng-container>
                        <ng-template #elseBlock>
                            <span class="d-print-none extra-function" [attr.aria-labelledby]="label('decorations')" (click)="$event.stopPropagation()" title="">
                                <label id="{{ label('decorations') }}" for="decorations checkbox" class="checkbox-inline">
                                    <input type="checkbox" id="decorations checkbox" [(ngModel)]="decorations" value="" role="checkbox" [attr.aria-labelledby]="label('decorations')">{{ ui['Decorations']?.text }}
                                </label>
                            </span>
                        </ng-template>
                    </h1>
                </header>
                <div id="{{ entities['Curriculum Vitae']?.content }}" class="collapse show">
                    <div class="columns2 clear-both">
                        <app-cv [sectionCounter]="sectionCounter" [headerLink]="headerLink"></app-cv>
                    </div>
                    <hr>
                    
                    <div #projectsAccomplishment *ngIf="projectsDefined()" class='{{ projectsAccomplishmentClassList }}' >
                        <div class="tryKeepTogether">
                            <header id="{{ entities['Gantt Chart Map']?.key }}" (click)="saveToggle($event)" data-toggle="collapse"
                                [attr.data-target]="'#' + entities['Gantt Chart Map']?.content" [attr.aria-labelledby]="tabName('Gantt Chart Map')">
                                <h3>
                                    <ng-container *ngTemplateOutlet="headerLink;context:{key: 'Gantt Chart Map'}"></ng-container>
                                    {{ entities['Gantt Chart Map']?.section }}
                                    <i class="fas fa-chart-line"></i>
                                    <ng-container *ngTemplateOutlet="sectionCounter;context:{count: filteredProjects.length}"></ng-container>
                                </h3>
                            </header>
                            <div id="{{ entities['Gantt Chart Map']?.content }}" class="collapse show">
                                <div class="columns1">
                                    <app-project-gantt-chart-map></app-project-gantt-chart-map>
                                </div>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div *ngIf="projectsDefined()">
            <div class="tryKeepTogether page-break">
                <header id="{{ entities['Project Summary']?.key }}" (click)="saveToggle($event)" data-toggle="collapse" [attr.data-target]="'#' + entities['Project Summary']?.content"
                    [attr.aria-labelledby]="tabName('Project Summary')">
                    <h1 [class.decorations]="decorations" class="columns1">
                        <ng-container *ngTemplateOutlet="headerLink;context:{key: 'Project Summary'}"></ng-container>
                        {{ entities['Project Summary']?.section }}
                        <ng-container *ngTemplateOutlet="sectionCounter;context:{count: countCache[entities['Project Summary']?.node]}"></ng-container>

                        <ng-container *ngIf="decorations; else elseBlock">
                            <span class="d-print-none extra-function toggle_radio" role="radiogroup" [attr.aria-labelledby]="label('viewMode')" (click)="$event.stopPropagation()"
                                title="{{ ui['Mode']?.text }}">
                                <input type="radio" class="toggle_option" id="first_toggle" [(ngModel)]="tagCloud" [value]="tagCloudDisplayMode.tagCloud"
                                    name="toggle_option" role="radio" [attr.aria-labelledby]="label('tag cloud')" title="" (click)="this.tagCloud=this.tagCloudDisplayMode.tagCloud">
                                <input type="radio" class="toggle_option" id="second_toggle" [(ngModel)]="tagCloud" [value]="tagCloudDisplayMode.chart" name="toggle_option"
                                    role="radio" [attr.aria-labelledby]="label('chart')" title="" (click)="this.tagCloud=this.tagCloudDisplayMode.chart">
                                <input type="radio" class="toggle_option" id="third_toggle" [(ngModel)]="tagCloud" [value]="tagCloudDisplayMode.both" name="toggle_option"
                                    role="radio" [attr.aria-labelledby]="label('both')" title="" (click)="this.tagCloud=this.tagCloudDisplayMode.both">
                                <label id="{{ label('tag cloud') }}" for="first_toggle">
                                    <p>{{ ui['tag cloud']?.text }}</p>
                                </label>
                                <label id="{{ label('chart') }}" for="second_toggle">
                                    <p>{{ ui['chart']?.text }}</p>
                                </label>
                                <label id="{{ label('both') }}" for="third_toggle">
                                    <p>{{ ui['both']?.text }}</p>
                                </label>
                                <div class="toggle_option_slider">
                                </div>
                            </span>
                        </ng-container>
                        <ng-template #elseBlock>
                            <span class="d-print-none extra-function" role="radiogroup" [attr.aria-labelledby]="label('viewMode')" (click)="$event.stopPropagation()"
                                title="">
                                <label id="{{ label('viewMode') }}" class="input-group-addon">{{ ui['Mode']?.text }}:</label>

                                <label id="{{ label('tag cloud') }}" for="tag cloud radio" class="radio-inline" (click)="this.tagCloud=this.tagCloudDisplayMode.tagCloud">
                                    <input type="radio" id="tag cloud radio" [(ngModel)]="tagCloud" [value]="tagCloudDisplayMode.tagCloud" name="options" role="radio"
                                        [attr.aria-labelledby]="label('tag cloud')">{{ ui['tag cloud']?.text }}
                                </label>
                                <label id="{{ label('chart') }}" for="chart radio" class="radio-inline" (click)="this.tagCloud=this.tagCloudDisplayMode.chart">
                                    <input type="radio" id="chart radio" [(ngModel)]="tagCloud" [value]="tagCloudDisplayMode.chart" name="options" role="radio"
                                        [attr.aria-labelledby]="label('chart')">{{ ui['chart']?.text }}
                                </label>
                                <label id="{{ label('both') }}" for="both radio" class="radio-inline" (click)="this.tagCloud=this.tagCloudDisplayMode.both">
                                    <input type="radio" id="both radio" [(ngModel)]="tagCloud" [value]="tagCloudDisplayMode.both" name="options" role="radio"
                                        [attr.aria-labelledby]="label('both')">{{ ui['both']?.text }}
                                </label>
                            </span>
                        </ng-template>
                    </h1>
                </header>
                <div id="{{ entities['Project Summary']?.content }}" class="collapse show">
                    <app-project-summary [sectionCounter]="sectionCounter" [headerLink]="headerLink"></app-project-summary>
                    <hr>
                </div>
            </div>

            <div class="tryKeepTogether page-break">
                <header id="{{ entities['Project Portfolio']?.key }}" (click)="saveToggle($event)" data-toggle="collapse" [attr.data-target]="'#' + entities['Project Portfolio']?.content"
                    [attr.aria-labelledby]="tabName('Project Portfolio')">
                    <h1 [class.decorations]="decorations">
                        <ng-container *ngTemplateOutlet="headerLink;context:{key: 'Project Portfolio'}"></ng-container>
                        {{ entities['Project Portfolio']?.section }}
                        <ng-container *ngTemplateOutlet="sectionCounter;context:{count: filteredProjects.length}"></ng-container>
                    </h1>
                </header>
                <div id="{{ entities['Project Portfolio']?.content }}" class="collapse show">
                    <div class="columns1">
                        <app-project [sectionCounter]="sectionCounter" [headerLink]="headerLink"></app-project>
                        <hr>
                    </div>
                </div>
            </div>
        </div>

        <app-general-timeline [sectionCounter]="sectionCounter" [headerLink]="headerLink"></app-general-timeline>

        <div class="page-break">
        </div>
    </div>
</main>

<aside role="complementary" class="container-fluid">
    <div *ngIf="(cvDefined() || projectsDefined()) && uiDefined()" class="d-print-none">
        <button id="goToTopBtn" type="button" class="btn btn-square close p-0 bd-highlight" [attr.aria-label]="ui['Go to top']?.text"
            (click)="goToTop()" title="{{ ui['Go to top']?.text }}">
            <img src="{{ getAssetUri('back_to_top.png') }}" onerror="this.style.display='none'" class="btn-square" alt="{{ ui['Up']?.text }}"
            />
        </button>

        <ng-container *ngTemplateOutlet="search;context:{position: ' bottom'}"></ng-container>
        <ng-container *ngTemplateOutlet="menu;context:{position: ' bottom'}"></ng-container>

    </div>
</aside>

<footer role="contentinfo" class="container-fluid">
    <div *ngIf="(cvDefined() || projectsDefined()) && uiDefined()" class="d-print-none">
        <app-footer [sectionCounter]="sectionCounter" [headerLink]="headerLink"></app-footer>
    </div>
</footer>